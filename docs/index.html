<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <meta name="theme-color" content="#2E5CFF">
    <title>알고PT Pro</title>
    <link rel="manifest" href="manifest.json">
    <link rel="icon" type="image/png" href="icon-192.png">
    <link rel="apple-touch-icon" href="icon-192.png">
    <link rel="stylesheet" href="styles.css">
</head>
<body>
    <!-- Splash Screen -->
    <div id="splash" class="splash">
        <div class="splash-content">
            <div class="splash-icon">
                <svg viewBox="0 0 24 24" fill="white" width="64" height="64">
                    <path d="M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zm-7 3c1.93 0 3.5 1.57 3.5 3.5S13.93 13 12 13s-3.5-1.57-3.5-3.5S10.07 6 12 6zm7 13H5v-.23c0-.62.28-1.2.76-1.58C7.47 15.82 9.64 15 12 15s4.53.82 6.24 2.19c.48.38.76.97.76 1.58V19z"/>
                </svg>
            </div>
            <h1 class="splash-title">알고PT Pro</h1>
            <p class="splash-subtitle">주니어 치료사를 위한 AI 임상 파트너</p>
            <div class="splash-loader">
                <div class="loader-bar"></div>
            </div>
            <p class="splash-loading">임상 데이터를 불러오는 중...</p>
        </div>
    </div>

    <!-- Main App -->
    <div id="app" class="app hidden">
        <!-- Header -->
        <header id="header" class="header">
            <h1 id="header-title">알고PT Pro</h1>
        </header>

        <!-- Screens Container -->
        <main id="screens" class="screens">
            <!-- Home Screen -->
            <section id="screen-home" class="screen active">
                <div class="home-hero">
                    <h2>알고PT Pro</h2>
                    <p>AI 임상 파트너</p>
                </div>
                <div class="card">
                    <h3><span class="icon">⚡</span> 빠른 시작</h3>
                    <div class="quick-actions">
                        <button class="quick-btn" onclick="navigateTo('subjective')">
                            <span class="quick-icon">➕</span>
                            <span>새 평가<br>시작</span>
                        </button>
                        <button class="quick-btn green" onclick="navigateTo('cdss')">
                            <span class="quick-icon">🔍</span>
                            <span>AI<br>검색</span>
                        </button>
                        <button class="quick-btn orange" onclick="navigateTo('objective')">
                            <span class="quick-icon">🦾</span>
                            <span>ROM<br>검사</span>
                        </button>
                    </div>
                </div>
                <div class="card">
                    <h3><span class="icon">📋</span> 평가 워크플로우</h3>
                    <div class="workflow">
                        <div class="workflow-step active">
                            <div class="step-num">1</div>
                            <div class="step-info">
                                <strong>주관적 평가</strong>
                                <small>환자정보, 주호소, 통증</small>
                            </div>
                            <span class="step-badge">시작</span>
                        </div>
                        <div class="workflow-line"></div>
                        <div class="workflow-step">
                            <div class="step-num">2</div>
                            <div class="step-info">
                                <strong>객관적 평가</strong>
                                <small>MAS, MMT, ROM</small>
                            </div>
                        </div>
                        <div class="workflow-line"></div>
                        <div class="workflow-step">
                            <div class="step-num">3</div>
                            <div class="step-info">
                                <strong>사정</strong>
                                <small>AI 임상 추론</small>
                            </div>
                        </div>
                        <div class="workflow-line"></div>
                        <div class="workflow-step">
                            <div class="step-num">4</div>
                            <div class="step-info">
                                <strong>계획</strong>
                                <small>EMR용 SOAP 노트</small>
                            </div>
                        </div>
                    </div>
                </div>
            </section>

            <!-- Subjective Screen -->
            <section id="screen-subjective" class="screen">
                <div class="card">
                    <h3><span class="icon">👤</span> 환자 정보</h3>
                    <div class="form-row">
                        <label>나이</label>
                        <div class="age-input-wrap">
                            <input type="number" id="age-input" class="age-input"
                                   value="50" min="1" max="120"
                                   oninput="updateAge(this.value)"
                                   onfocus="this.select()"
                                   inputmode="numeric" pattern="[0-9]*">
                            <span class="age-unit">세</span>
                        </div>
                    </div>
                    <div class="form-row">
                        <label>성별</label>
                        <div class="gender-picker">
                            <button id="gender-m" class="gender-btn" onclick="setGender('M')">
                                <span>♂</span> 남성
                            </button>
                            <button id="gender-f" class="gender-btn" onclick="setGender('F')">
                                <span>♀</span> 여성
                            </button>
                        </div>
                    </div>
                </div>

                <div class="card">
                    <h3><span class="icon">🏥</span> 주호소 (C.C)</h3>
                    <div id="cc-categories" class="category-list">
                        <!-- Generated by JS -->
                    </div>
                </div>

                <div class="card">
                    <h3><span class="icon">💊</span> 통증 평가 (VAS)</h3>
                    <p class="hint">신체 부위를 탭한 후 통증 강도를 설정하세요</p>

                    <div class="body-views">
                        <div class="body-view-item">
                            <span class="view-label">앞면</span>
                            <svg id="body-front" viewBox="0 0 180 400" class="body-svg">
                                <!-- Clean anatomical outline - Front view -->
                                <g class="body-line-art" fill="none" stroke="#1E293B" stroke-width="1.2" stroke-linecap="round" stroke-linejoin="round">
                                    <!-- Head -->
                                    <ellipse cx="90" cy="28" rx="20" ry="24"/>
                                    <path d="M78,18 Q82,8 90,6 Q98,8 102,18"/>
                                    <!-- Face details -->
                                    <path d="M82,24 L84,24 M96,24 L98,24"/>
                                    <path d="M87,32 Q90,35 93,32"/>
                                    <!-- Neck -->
                                    <path d="M82,50 L82,58 M98,50 L98,58"/>
                                    <!-- Shoulders & Torso -->
                                    <path d="M82,58 Q70,60 55,65 Q40,70 25,75 L18,78"/>
                                    <path d="M98,58 Q110,60 125,65 Q140,70 155,75 L162,78"/>
                                    <!-- Chest outline -->
                                    <path d="M65,75 Q75,72 90,72 Q105,72 115,75"/>
                                    <path d="M70,85 Q90,90 110,85"/>
                                    <!-- Torso sides -->
                                    <path d="M65,75 L62,130 Q60,145 65,160"/>
                                    <path d="M115,75 L118,130 Q120,145 115,160"/>
                                    <!-- Arms -->
                                    <path d="M18,78 Q12,82 8,95 L5,130 Q3,145 8,160 L15,180"/>
                                    <path d="M162,78 Q168,82 172,95 L175,130 Q177,145 172,160 L165,180"/>
                                    <!-- Hands -->
                                    <path d="M15,180 Q10,185 8,195 Q6,208 12,218 Q18,225 25,222 Q30,218 28,208"/>
                                    <path d="M165,180 Q170,185 172,195 Q174,208 168,218 Q162,225 155,222 Q150,218 152,208"/>
                                    <!-- Waist -->
                                    <path d="M65,160 Q90,165 115,160"/>
                                    <!-- Hip area -->
                                    <path d="M65,160 Q55,175 58,195"/>
                                    <path d="M115,160 Q125,175 122,195"/>
                                    <path d="M58,195 Q90,200 122,195"/>
                                    <!-- Legs -->
                                    <path d="M65,200 L62,270 Q60,285 62,300 L65,360 Q68,375 75,385"/>
                                    <path d="M85,200 L82,270 Q80,285 82,300 L80,360 Q78,375 75,385"/>
                                    <path d="M95,200 L98,270 Q100,285 98,300 L100,360 Q102,375 105,385"/>
                                    <path d="M115,200 L118,270 Q120,285 118,300 L115,360 Q112,375 105,385"/>
                                    <!-- Feet -->
                                    <path d="M75,385 Q65,388 60,392 L62,398 L85,398 L85,388"/>
                                    <path d="M105,385 Q115,388 120,392 L118,398 L95,398 L95,388"/>
                                    <!-- Anatomical details -->
                                    <path d="M80,100 Q90,108 100,100" stroke-width="0.8"/>
                                    <ellipse cx="90" cy="140" rx="8" ry="6" stroke-width="0.8"/>
                                </g>
                                <!-- Invisible clickable regions -->
                                <ellipse cx="90" cy="28" rx="22" ry="26" class="body-part" data-part="머리"/>
                                <rect x="78" y="52" width="24" height="18" class="body-part" data-part="목"/>
                                <ellipse cx="45" cy="72" rx="20" ry="12" class="body-part" data-part="우측 어깨"/>
                                <ellipse cx="135" cy="72" rx="20" ry="12" class="body-part" data-part="좌측 어깨"/>
                                <path d="M62,70 L118,70 L118,100 L62,100 Z" class="body-part" data-part="가슴"/>
                                <rect x="5" y="78" width="20" height="50" class="body-part" data-part="우측 상완"/>
                                <rect x="155" y="78" width="20" height="50" class="body-part" data-part="좌측 상완"/>
                                <ellipse cx="10" cy="140" rx="12" ry="15" class="body-part" data-part="우측 팔꿈치"/>
                                <ellipse cx="170" cy="140" rx="12" ry="15" class="body-part" data-part="좌측 팔꿈치"/>
                                <rect x="3" y="150" width="18" height="35" class="body-part" data-part="우측 전완"/>
                                <rect x="160" y="150" width="18" height="35" class="body-part" data-part="좌측 전완"/>
                                <ellipse cx="18" cy="205" rx="15" ry="20" class="body-part" data-part="우측 손"/>
                                <ellipse cx="162" cy="205" rx="15" ry="20" class="body-part" data-part="좌측 손"/>
                                <path d="M62,102 L118,102 L115,145 L65,145 Z" class="body-part" data-part="복부"/>
                                <path d="M65,148 L115,148 L118,195 L62,195 Z" class="body-part" data-part="골반"/>
                                <path d="M60,200 L88,200 L85,280 L62,280 Z" class="body-part" data-part="우측 대퇴"/>
                                <path d="M92,200 L120,200 L118,280 L95,280 Z" class="body-part" data-part="좌측 대퇴"/>
                                <ellipse cx="73" cy="295" rx="15" ry="20" class="body-part" data-part="우측 무릎"/>
                                <ellipse cx="107" cy="295" rx="15" ry="20" class="body-part" data-part="좌측 무릎"/>
                                <path d="M60,310 L86,310 L82,365 L65,365 Z" class="body-part" data-part="우측 하퇴"/>
                                <path d="M94,310 L120,310 L115,365 L98,365 Z" class="body-part" data-part="좌측 하퇴"/>
                                <path d="M58,368 L88,368 L88,400 L58,400 Z" class="body-part" data-part="우측 발"/>
                                <path d="M92,368 L122,368 L122,400 L92,400 Z" class="body-part" data-part="좌측 발"/>
                            </svg>
                        </div>
                        <div class="body-view-item">
                            <span class="view-label">뒷면</span>
                            <svg id="body-back" viewBox="0 0 180 400" class="body-svg">
                                <!-- Clean anatomical outline - Back view -->
                                <g class="body-line-art" fill="none" stroke="#1E293B" stroke-width="1.2" stroke-linecap="round" stroke-linejoin="round">
                                    <!-- Head -->
                                    <ellipse cx="90" cy="28" rx="20" ry="24"/>
                                    <path d="M78,20 Q82,10 90,8 Q98,10 102,20"/>
                                    <!-- Neck -->
                                    <path d="M82,50 L82,58 M98,50 L98,58"/>
                                    <!-- Shoulders & Back -->
                                    <path d="M82,58 Q70,60 55,65 Q40,70 25,75 L18,78"/>
                                    <path d="M98,58 Q110,60 125,65 Q140,70 155,75 L162,78"/>
                                    <!-- Back outline -->
                                    <path d="M65,75 L62,130 Q60,145 65,160"/>
                                    <path d="M115,75 L118,130 Q120,145 115,160"/>
                                    <!-- Spine -->
                                    <path d="M90,58 L90,160" stroke-dasharray="4,3" stroke-width="1"/>
                                    <!-- Shoulder blades -->
                                    <path d="M70,85 Q78,95 75,105 Q72,110 68,105" stroke-width="0.8"/>
                                    <path d="M110,85 Q102,95 105,105 Q108,110 112,105" stroke-width="0.8"/>
                                    <!-- Arms -->
                                    <path d="M18,78 Q12,82 8,95 L5,130 Q3,145 8,160 L15,180"/>
                                    <path d="M162,78 Q168,82 172,95 L175,130 Q177,145 172,160 L165,180"/>
                                    <!-- Hands -->
                                    <path d="M15,180 Q10,185 8,195 Q6,208 12,218 Q18,225 25,222 Q30,218 28,208"/>
                                    <path d="M165,180 Q170,185 172,195 Q174,208 168,218 Q162,225 155,222 Q150,218 152,208"/>
                                    <!-- Lower back -->
                                    <path d="M65,160 Q90,165 115,160"/>
                                    <!-- Buttocks -->
                                    <path d="M65,160 Q55,175 58,195"/>
                                    <path d="M115,160 Q125,175 122,195"/>
                                    <path d="M58,195 Q90,200 122,195"/>
                                    <path d="M72,175 Q78,190 90,192 Q102,190 108,175" stroke-width="0.8"/>
                                    <!-- Legs -->
                                    <path d="M65,200 L62,270 Q60,285 62,300 L65,360 Q68,375 75,385"/>
                                    <path d="M85,200 L82,270 Q80,285 82,300 L80,360 Q78,375 75,385"/>
                                    <path d="M95,200 L98,270 Q100,285 98,300 L100,360 Q102,375 105,385"/>
                                    <path d="M115,200 L118,270 Q120,285 118,300 L115,360 Q112,375 105,385"/>
                                    <!-- Calves detail -->
                                    <path d="M68,320 Q73,340 70,355" stroke-width="0.8"/>
                                    <path d="M112,320 Q107,340 110,355" stroke-width="0.8"/>
                                    <!-- Feet -->
                                    <path d="M75,385 Q68,390 70,398 L82,398 L82,388"/>
                                    <path d="M105,385 Q112,390 110,398 L98,398 L98,388"/>
                                </g>
                                <!-- Invisible clickable regions -->
                                <ellipse cx="90" cy="28" rx="22" ry="26" class="body-part" data-part="머리(후)"/>
                                <rect x="78" y="52" width="24" height="18" class="body-part" data-part="목(후)"/>
                                <ellipse cx="45" cy="72" rx="20" ry="12" class="body-part" data-part="우측 어깨(후)"/>
                                <ellipse cx="135" cy="72" rx="20" ry="12" class="body-part" data-part="좌측 어깨(후)"/>
                                <path d="M62,70 L118,70 L118,100 L62,100 Z" class="body-part" data-part="등(상부)"/>
                                <rect x="5" y="78" width="20" height="50" class="body-part" data-part="우측 상완(후)"/>
                                <rect x="155" y="78" width="20" height="50" class="body-part" data-part="좌측 상완(후)"/>
                                <ellipse cx="10" cy="140" rx="12" ry="15" class="body-part" data-part="우측 팔꿈치(후)"/>
                                <ellipse cx="170" cy="140" rx="12" ry="15" class="body-part" data-part="좌측 팔꿈치(후)"/>
                                <rect x="3" y="150" width="18" height="35" class="body-part" data-part="우측 전완(후)"/>
                                <rect x="160" y="150" width="18" height="35" class="body-part" data-part="좌측 전완(후)"/>
                                <ellipse cx="18" cy="205" rx="15" ry="20" class="body-part" data-part="우측 손(후)"/>
                                <ellipse cx="162" cy="205" rx="15" ry="20" class="body-part" data-part="좌측 손(후)"/>
                                <path d="M62,102 L118,102 L115,145 L65,145 Z" class="body-part" data-part="허리"/>
                                <path d="M55,148 L125,148 L125,200 L55,200 Z" class="body-part" data-part="둔부"/>
                                <path d="M60,202 L88,202 L85,280 L62,280 Z" class="body-part" data-part="우측 햄스트링"/>
                                <path d="M92,202 L120,202 L118,280 L95,280 Z" class="body-part" data-part="좌측 햄스트링"/>
                                <ellipse cx="73" cy="295" rx="15" ry="18" class="body-part" data-part="우측 슬와"/>
                                <ellipse cx="107" cy="295" rx="15" ry="18" class="body-part" data-part="좌측 슬와"/>
                                <path d="M60,310 L86,310 L82,365 L65,365 Z" class="body-part" data-part="우측 종아리"/>
                                <path d="M94,310 L120,310 L115,365 L98,365 Z" class="body-part" data-part="좌측 종아리"/>
                                <ellipse cx="75" cy="392" rx="12" ry="10" class="body-part" data-part="우측 발뒤꿈치"/>
                                <ellipse cx="105" cy="392" rx="12" ry="10" class="body-part" data-part="좌측 발뒤꿈치"/>
                            </svg>
                        </div>
                    </div>

                    <div class="pain-list-section">
                        <h4>통증 부위 <span id="pain-count" class="pain-count-badge">0</span></h4>
                        <div id="pain-locations">
                            <p class="empty-hint">신체 부위를 탭하여 추가</p>
                        </div>
                    </div>
                </div>
            </section>

            <!-- Objective Screen -->
            <section id="screen-objective" class="screen">
                <div class="tabs">
                    <button class="tab active" onclick="switchObjectiveTab('mas')">MAS</button>
                    <button class="tab" onclick="switchObjectiveTab('mmt')">MMT</button>
                    <button class="tab" onclick="switchObjectiveTab('rom')">ROM</button>
                    <button class="tab" onclick="switchObjectiveTab('bbs')">BBS</button>
                </div>

                <!-- MAS Tab -->
                <div id="tab-mas" class="tab-content active">
                    <div class="quick-action-bar">
                        <button class="action-btn green" onclick="setAllMasNormal()">✓ 전체 정상</button>
                        <button class="action-btn red" onclick="clearAllMas()">🗑 초기화</button>
                    </div>
                    <div class="info-card legend-card">
                        <h4>수정 애쉬워스 척도 (Modified Ashworth Scale)</h4>
                        <div class="grade-legend-grid">
                            <div class="legend-item"><span class="legend-badge" style="background:#10B981">0</span><span class="legend-text">정상 - 근긴장도 증가 없음</span></div>
                            <div class="legend-item"><span class="legend-badge" style="background:#34D399">1</span><span class="legend-text">ROM 끝에서 catch 또는 최소 저항</span></div>
                            <div class="legend-item"><span class="legend-badge" style="background:#FBBF24">1+</span><span class="legend-text">Catch 후 ROM ½ 미만에서 저항</span></div>
                            <div class="legend-item"><span class="legend-badge" style="background:#F59E0B">2</span><span class="legend-text">ROM 대부분 저항↑, 수동운동 가능</span></div>
                            <div class="legend-item"><span class="legend-badge" style="background:#EF4444">3</span><span class="legend-text">현저한 긴장도↑, 수동운동 어려움</span></div>
                            <div class="legend-item"><span class="legend-badge" style="background:#DC2626">4</span><span class="legend-text">강직(Rigid) - 굴곡/신전 고정</span></div>
                        </div>
                    </div>
                    <div id="mas-list" class="assessment-list bilateral">
                        <!-- Generated by JS -->
                    </div>
                </div>

                <!-- MMT Tab -->
                <div id="tab-mmt" class="tab-content">
                    <div class="quick-action-bar">
                        <button class="action-btn green" onclick="setAllMmtNormal()">✓ 전체 정상</button>
                        <button class="action-btn red" onclick="clearAllMmt()">🗑 초기화</button>
                    </div>
                    <div class="info-card legend-card">
                        <h4>도수근력검사 (Manual Muscle Test)</h4>
                        <div class="grade-legend-grid mmt">
                            <div class="legend-item"><span class="legend-badge small">0</span><span class="legend-text">근수축 없음</span></div>
                            <div class="legend-item"><span class="legend-badge small">T</span><span class="legend-text">촉진 시 수축, 움직임 없음</span></div>
                            <div class="legend-item"><span class="legend-badge small">P-</span><span class="legend-text">중력제거 부분ROM</span></div>
                            <div class="legend-item"><span class="legend-badge small">P</span><span class="legend-text">중력제거 완전ROM</span></div>
                            <div class="legend-item"><span class="legend-badge small">P+</span><span class="legend-text">중력제거+약간저항</span></div>
                            <div class="legend-item"><span class="legend-badge small">F-</span><span class="legend-text">항중력 부분ROM</span></div>
                            <div class="legend-item"><span class="legend-badge small">F</span><span class="legend-text">항중력 완전ROM</span></div>
                            <div class="legend-item"><span class="legend-badge small">F+</span><span class="legend-text">항중력+약간저항</span></div>
                            <div class="legend-item"><span class="legend-badge small">G-</span><span class="legend-text">중등도저항 부분ROM</span></div>
                            <div class="legend-item"><span class="legend-badge small">G</span><span class="legend-text">중등도저항 완전ROM</span></div>
                            <div class="legend-item"><span class="legend-badge small">G+</span><span class="legend-text">중등도 이상 저항</span></div>
                            <div class="legend-item"><span class="legend-badge small" style="background:#10B981">N</span><span class="legend-text">정상 - 최대저항 완전ROM</span></div>
                        </div>
                    </div>
                    <div id="mmt-list" class="assessment-list bilateral">
                        <!-- Generated by JS -->
                    </div>
                </div>

                <!-- ROM Tab -->
                <div id="tab-rom" class="tab-content">
                    <div class="rom-controls">
                        <div class="rom-selectors">
                            <select id="rom-joint-select" class="joint-select" onchange="selectRomJoint(this.value)">
                                <option value="shoulder">어깨</option>
                                <option value="elbow">팔꿈치</option>
                                <option value="wrist">손목</option>
                                <option value="hip">고관절</option>
                                <option value="knee">무릎</option>
                                <option value="ankle">발목</option>
                            </select>
                            <div class="side-toggle-inline">
                                <button id="rom-side-r" class="side-btn-sm active" onclick="setRomSide('R')">우</button>
                                <button id="rom-side-l" class="side-btn-sm" onclick="setRomSide('L')">좌</button>
                            </div>
                        </div>
                        <button class="wnl-all-btn" onclick="setAllRomWnl()">전체 Full</button>
                    </div>
                    <div id="rom-movement-list" class="rom-movement-grid">
                        <!-- Generated by JS -->
                    </div>
                    <div class="card rom-card">
                        <h3 id="rom-movement-title">어깨 굴곡</h3>
                        <p id="rom-normal-range" class="hint">정상범위: 0° - 180°</p>
                        <button id="rom-wnl-btn" class="wnl-btn" onclick="toggleRomWnl()">
                            <span class="wnl-check">○</span> 정상
                        </button>
                        <div id="rom-slider-container" class="rom-slider-container">
                            <div class="rom-display">
                                <div class="mannequin-container">
                                    <svg id="rom-mannequin" viewBox="0 0 200 300" class="mannequin">
                                        <!-- Head -->
                                        <ellipse cx="100" cy="25" rx="18" ry="22" fill="#2E5CFF" opacity="0.8"/>
                                        <!-- Neck -->
                                        <rect x="92" y="45" width="16" height="12" fill="#2E5CFF" opacity="0.8"/>
                                        <!-- Torso -->
                                        <path d="M65 60 L135 60 L130 140 L70 140 Z" fill="#2E5CFF" opacity="0.8"/>
                                        <!-- Left Arm (static) -->
                                        <g id="left-arm-group">
                                            <rect x="135" y="65" width="14" height="45" rx="5" fill="#2E5CFF" opacity="0.6"/>
                                            <rect x="138" y="110" width="12" height="40" rx="4" fill="#2E5CFF" opacity="0.6"/>
                                        </g>
                                        <!-- Right Arm (animated) -->
                                        <g id="right-arm-group" transform-origin="65 70">
                                            <rect x="51" y="65" width="14" height="45" rx="5" fill="#00C896"/>
                                            <circle cx="58" cy="110" r="6" fill="#009670"/>
                                            <rect id="right-forearm" x="52" y="110" width="12" height="40" rx="4" fill="#00C896"/>
                                        </g>
                                        <!-- Pelvis -->
                                        <path d="M70 145 L130 145 L120 175 L80 175 Z" fill="#2E5CFF" opacity="0.8"/>
                                        <!-- Legs -->
                                        <rect x="75" y="180" width="18" height="60" rx="6" fill="#2E5CFF" opacity="0.8"/>
                                        <rect x="107" y="180" width="18" height="60" rx="6" fill="#2E5CFF" opacity="0.8"/>
                                        <rect x="77" y="245" width="14" height="45" rx="5" fill="#2E5CFF" opacity="0.8"/>
                                        <rect x="109" y="245" width="14" height="45" rx="5" fill="#2E5CFF" opacity="0.8"/>
                                    </svg>
                                </div>
                                <div class="angle-control">
                                    <div class="angle-dial">
                                        <svg viewBox="0 0 150 150" class="dial-svg">
                                            <circle cx="75" cy="75" r="60" fill="none" stroke="#E8ECF2" stroke-width="10"/>
                                            <circle id="dial-progress" cx="75" cy="75" r="60" fill="none" stroke="#00C896" stroke-width="10"
                                                stroke-dasharray="377" stroke-dashoffset="377" stroke-linecap="round"
                                                transform="rotate(-90 75 75)"/>
                                            <circle id="dial-thumb" cx="75" cy="15" r="12" fill="white" stroke="#00C896" stroke-width="3" style="filter: drop-shadow(0 2px 4px rgba(0,0,0,0.2))"/>
                                        </svg>
                                        <div id="angle-value" class="angle-value">0°</div>
                                    </div>
                                    <input type="range" id="rom-slider" class="rom-range" min="0" max="180" value="0" step="5"
                                        oninput="updateRomAngle(this.value)">
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- BBS Tab (Berg Balance Scale) -->
                <div id="tab-bbs" class="tab-content">
                    <div class="quick-action-bar">
                        <button class="action-btn red" onclick="clearAllBbs()">🗑 초기화</button>
                    </div>
                    <div class="bbs-score-card">
                        <div class="bbs-total-wrap">
                            <span class="bbs-label">총점</span>
                            <span id="bbs-total" class="bbs-total">0/56</span>
                        </div>
                        <div id="bbs-interpret" class="bbs-interpret">
                            <span class="bbs-count">(0/14 항목)</span>
                        </div>
                    </div>
                    <div class="info-card legend-card bbs-info-card">
                        <h4>버그 균형 척도 (Berg Balance Scale)</h4>
                        <p class="bbs-info-desc">14개 항목 · 각 0-4점 · 총 56점</p>
                        <div class="bbs-score-guide">
                            <div class="score-guide-item">
                                <span class="guide-badge" style="background:#DC2626">0</span>
                                <span class="guide-text">불가</span>
                            </div>
                            <div class="score-guide-item">
                                <span class="guide-badge" style="background:#F59E0B">1</span>
                                <span class="guide-text">최소</span>
                            </div>
                            <div class="score-guide-item">
                                <span class="guide-badge" style="background:#EAB308">2</span>
                                <span class="guide-text">감독</span>
                            </div>
                            <div class="score-guide-item">
                                <span class="guide-badge" style="background:#10B981">3</span>
                                <span class="guide-text">거의</span>
                            </div>
                            <div class="score-guide-item">
                                <span class="guide-badge" style="background:#06B6D4">4</span>
                                <span class="guide-text">독립</span>
                            </div>
                        </div>
                        <div class="bbs-risk-summary">
                            <span class="risk-chip high">0-20 휠체어</span>
                            <span class="risk-chip medium">21-40 보조</span>
                            <span class="risk-chip low">41-56 독립</span>
                        </div>
                    </div>
                    <div id="bbs-list" class="bbs-list">
                        <!-- Generated by JS -->
                    </div>
                </div>
            </section>

            <!-- CDSS Screen -->
            <section id="screen-cdss" class="screen">
                <div class="card">
                    <div class="cdss-header">
                        <div class="cdss-icon">🧠</div>
                        <div>
                            <h3>근거 기반 검색</h3>
                            <p class="hint">임상 가이드라인 및 중재법 검색</p>
                        </div>
                    </div>
                    <button class="primary-btn full-width" onclick="searchInterventions()">
                        🔍 이 케이스에 맞는 중재법 검색
                    </button>
                </div>

                <div class="card">
                    <h3><span class="icon">⚡</span> 질환별 빠른 검색</h3>
                    <div id="condition-chips" class="chips">
                        <!-- Generated by JS -->
                    </div>
                </div>

                <div id="cdss-loading" class="card hidden">
                    <div class="loading-spinner"></div>
                    <p class="loading-text">임상 데이터를 분석 중입니다...</p>
                    <p class="loading-sub">근거 기반 가이드라인 검색 중...</p>
                </div>

                <div id="cdss-result" class="card hidden">
                    <h3><span class="icon">📄</span> 임상 권고사항</h3>
                    <div id="result-content" class="result-content"></div>
                    <button class="secondary-btn full-width" onclick="generateSoapNote()">
                        📝 SOAP 노트 생성
                    </button>
                </div>

                <div id="soap-note" class="card hidden">
                    <div class="soap-header">
                        <h3><span class="icon">📋</span> SOAP 노트</h3>
                        <button class="copy-btn" onclick="copySoapNote()">
                            📋 EMR 복사
                        </button>
                    </div>
                    <pre id="soap-content" class="soap-content"></pre>
                </div>
            </section>
        </main>

        <!-- Bottom Navigation -->
        <nav class="bottom-nav">
            <button class="nav-item active" onclick="navigateTo('home')">
                <span class="nav-icon">🏠</span>
                <span>홈</span>
            </button>
            <button class="nav-item" onclick="navigateTo('subjective')">
                <span class="nav-icon">👤</span>
                <span>주관적</span>
            </button>
            <button class="nav-item" onclick="navigateTo('objective')">
                <span class="nav-icon">📊</span>
                <span>객관적</span>
            </button>
            <button class="nav-item" onclick="navigateTo('cdss')">
                <span class="nav-icon">🧠</span>
                <span>AI 지원</span>
            </button>
        </nav>
    </div>

    <!-- VAS Modal -->
    <div id="vas-modal" class="modal hidden">
        <div class="modal-content">
            <div class="modal-handle"></div>
            <h3 id="vas-part-name">부위명</h3>
            <p class="hint">통증 강도 설정 (VAS)</p>
            <div class="vas-slider-container">
                <svg viewBox="0 0 220 120" class="vas-arc">
                    <defs>
                        <linearGradient id="vas-gradient" x1="0%" y1="0%" x2="100%" y2="0%">
                            <stop offset="0%" style="stop-color:#4CAF50"/>
                            <stop offset="50%" style="stop-color:#FFEB3B"/>
                            <stop offset="100%" style="stop-color:#FF5722"/>
                        </linearGradient>
                    </defs>
                    <path d="M 20 100 A 90 90 0 0 1 200 100" fill="none" stroke="#E8ECF2" stroke-width="16" stroke-linecap="round"/>
                    <path id="vas-arc-progress" d="M 20 100 A 90 90 0 0 1 200 100" fill="none" stroke="url(#vas-gradient)" stroke-width="16" stroke-linecap="round" stroke-dasharray="283" stroke-dashoffset="283"/>
                    <circle id="vas-thumb" cx="20" cy="100" r="14" fill="white" stroke="#4CAF50" stroke-width="3" style="filter: drop-shadow(0 2px 4px rgba(0,0,0,0.3))"/>
                </svg>
                <div id="vas-value" class="vas-value">0</div>
            </div>
            <input type="range" id="vas-range" class="vas-range" min="0" max="10" value="0" oninput="updateVasValue(this.value)">
            <div class="vas-labels">
                <span class="vas-low">통증 없음</span>
                <span class="vas-high">극심한 통증</span>
            </div>
            <div class="modal-buttons">
                <button class="secondary-btn" onclick="removeVasPain()">삭제</button>
                <button class="primary-btn" onclick="saveVasPain()">저장</button>
            </div>
        </div>
    </div>

    <!-- Toast -->
    <div id="toast" class="toast hidden"></div>

    <script src="app.js"></script>
</body>
</html>
